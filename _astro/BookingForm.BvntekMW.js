import{j as e,c as u}from"./cn.zzlncTwb.js";import{r as m}from"./index.BmW6Ki2V.js";import{I as x,T as M,B as R}from"./Textarea.-kQNaIpf.js";import{A as H}from"./AddressAutocomplete.CQRvx8Ki.js";import{u as W,L as _,f as J,v as p,a as z,b as U}from"./LegalModal.CIRfRcHK.js";import{s as V}from"./site.config.CN9kl7_B.js";import"./proxy.DU87lMsk.js";import"./createLucideIcon.w0v_EZ4H.js";import"./index.CoPBpCLj.js";const K=["Morning (8am - 12pm)","Afternoon (12pm - 5pm)","Evening (5pm - 8pm)","Flexible / Any Time"],G=[{value:"standard",label:"Standard - Within a few days"},{value:"soon",label:"Soon - Within 24-48 hours"},{value:"urgent",label:"Urgent - As soon as possible"}];function ae({recaptchaSiteKey:r,endpoint:s="/api/contact.php",className:a,onSuccess:t,onError:n}){const o=V.services.map(e=>e.name),[i,l]=m.useState({name:"",email:"",phone:"",address:"",service:"",preferredDate:"",preferredTime:"",urgency:"standard",message:"",website:""}),[c,d]=m.useState({}),[h,f]=m.useState(!1),[g,b]=m.useState(!1),[v,j]=m.useState(!1),[y,N]=m.useState(null),{executeRecaptcha:k,isLoaded:w}=W({siteKey:r,action:"booking_form"}),C=(new Date).toISOString().split("T")[0],S=(e,r)=>{l(s=>({...s,[e]:r}));const s=e;c[s]&&d(e=>({...e,[s]:void 0}))};return g?e.jsxs("div",{className:u("rounded-xl bg-success-50 p-8 text-center",a),children:[e.jsx("div",{className:"mx-auto mb-4 flex h-16 w-16 items-center justify-center rounded-full bg-success-100",children:e.jsx("svg",{className:"h-8 w-8 text-success-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("h3",{className:"text-xl font-bold text-success-900",children:"Booking Request Submitted!"}),e.jsx("p",{className:"mt-2 text-success-700",children:"Thank you! We'll contact you shortly to confirm your appointment."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),(()=>{const e={};return p(i.name)||(e.name="Name is required"),i.email&&!z(i.email)&&(e.email="Please enter a valid email address"),p(i.phone)?U(i.phone)||(e.phone="Please enter a valid US phone number"):e.phone="Phone number is required",p(i.address)||(e.address="Service address is required"),p(i.service)||(e.service="Please select a service"),v||(e.consent="Please agree to be contacted"),d(e),0===Object.keys(e).length})()){if(i.website)return void b(!0);f(!0),d({});try{const e=await k("booking_form");if(!e)throw new Error("reCAPTCHA verification failed. Please try again.");const r=new FormData;Object.entries(i).forEach(([e,s])=>{"addressComponents"===e?r.append(e,JSON.stringify(s)):"phone"===e?r.append(e,J(s)):r.append(e,s)}),r.append("recaptcha_token",e);const a=sessionStorage.getItem("marketing_params");if(a)try{const e=JSON.parse(a);Object.keys(e).forEach(s=>{r.append(s,e[s])})}catch(e){console.error("[BookingForm] Error parsing tracking params:",e)}const n=await fetch(s,{method:"POST",body:r}),o=await n.json();if(!n.ok||!o.success)throw new Error(o.message||"Failed to submit booking request");b(!0),sessionStorage.setItem("form_submitted","true"),window.location.href="/thank-you/?type=booking",t&&t()}catch(e){const r=e instanceof Error?e.message:"An error occurred";d({form:r}),n&&n(r)}finally{f(!1)}}},className:u("space-y-6",a),noValidate:!0,children:[c.form&&e.jsx("div",{className:"rounded-lg bg-destructive/10 p-4 text-sm text-destructive",children:c.form}),e.jsx("div",{className:"absolute -left-[9999px]","aria-hidden":"true",children:e.jsx("input",{type:"text",name:"website",value:i.website,onChange:e=>S("website",e.target.value),tabIndex:-1,autoComplete:"off"})}),e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-semibold",children:[e.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-primary text-xs text-primary-foreground",children:"1"}),"Contact Information"]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsx(x,{label:"Full Name",name:"name",type:"text",placeholder:"John Smith",value:i.name,onChange:e=>S("name",e.target.value),error:c.name,required:!0,autoComplete:"name"}),e.jsx(x,{label:"Phone Number",name:"phone",type:"tel",placeholder:"(555) 000-0000",value:i.phone,onChange:e=>S("phone",e.target.value),error:c.phone,required:!0,autoComplete:"tel"})]}),e.jsx("div",{className:"mt-4",children:e.jsx(x,{label:"Email Address",name:"email",type:"email",placeholder:"john@example.com",value:i.email,onChange:e=>S("email",e.target.value),error:c.email,required:!0,autoComplete:"email"})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-semibold",children:[e.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-primary text-xs text-primary-foreground",children:"2"}),"Service Details"]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{htmlFor:"service",className:"block text-sm font-medium text-foreground",children:["Service Needed ",e.jsx("span",{className:"text-destructive",children:"*"})]}),e.jsxs("select",{id:"service",name:"service",value:i.service,onChange:e=>S("service",e.target.value),required:!0,className:u("w-full rounded-lg border bg-background px-4 py-3 text-foreground transition-colors","focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",c.service?"border-destructive":"border-input"),children:[e.jsx("option",{value:"",children:"Select a service..."}),o.map(r=>e.jsx("option",{value:r,children:r},r))]}),c.service&&e.jsx("p",{className:"text-sm text-destructive",children:c.service})]}),e.jsx("div",{className:"mt-4",children:e.jsx(H,{name:"address",label:"Service Address",placeholder:"Enter the address where service is needed",required:!0,onAddressSelect:e=>{l(r=>({...r,address:e.formattedAddress,addressComponents:e})),c.address&&d(e=>({...e,address:void 0}))},error:c.address})})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-semibold",children:[e.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-primary text-xs text-primary-foreground",children:"3"}),"Scheduling Preferences"]}),e.jsxs("div",{className:"grid gap-4 sm:grid-cols-2",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"preferredDate",className:"block text-sm font-medium text-foreground",children:"Preferred Date"}),e.jsx("input",{type:"date",id:"preferredDate",name:"preferredDate",min:C,value:i.preferredDate,onChange:e=>S("preferredDate",e.target.value),className:"w-full rounded-lg border border-input bg-background px-4 py-3 text-foreground transition-colors focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{htmlFor:"preferredTime",className:"block text-sm font-medium text-foreground",children:"Preferred Time"}),e.jsxs("select",{id:"preferredTime",name:"preferredTime",value:i.preferredTime,onChange:e=>S("preferredTime",e.target.value),className:"w-full rounded-lg border border-input bg-background px-4 py-3 text-foreground transition-colors focus:border-primary focus:outline-none focus:ring-2 focus:ring-primary/20",children:[e.jsx("option",{value:"",children:"Select preferred time..."}),K.map(r=>e.jsx("option",{value:r,children:r},r))]})]})]}),e.jsxs("div",{className:"mt-4 space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-foreground",children:"How urgent is your request?"}),e.jsx("div",{className:"grid gap-3 sm:grid-cols-3",children:G.map(r=>e.jsxs("label",{className:u("flex cursor-pointer items-center gap-3 rounded-lg border p-3 transition-colors",i.urgency===r.value?"border-primary bg-primary/5":"border-input hover:border-primary/50"),children:[e.jsx("input",{type:"radio",name:"urgency",value:r.value,checked:i.urgency===r.value,onChange:e=>S("urgency",e.target.value),className:"h-4 w-4 text-primary"}),e.jsx("span",{className:"text-sm",children:r.label})]},r.value))})]})]}),e.jsxs("div",{children:[e.jsxs("h3",{className:"mb-4 flex items-center gap-2 font-semibold",children:[e.jsx("span",{className:"flex h-6 w-6 items-center justify-center rounded-full bg-primary text-xs text-primary-foreground",children:"4"}),"Additional Information"]}),e.jsx(M,{label:"Describe your locksmith needs",name:"message",placeholder:"Please provide any additional details about your situation, such as the type of lock, specific issues, or any other relevant information...",value:i.message,onChange:e=>S("message",e.target.value),rows:4})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("label",{className:"flex items-start gap-3 cursor-pointer group",children:[e.jsx("input",{type:"checkbox",checked:v,onChange:e=>{j(e.target.checked),c.consent&&d(e=>({...e,consent:void 0}))},className:"mt-0.5 h-4 w-4 rounded border-input text-primary focus:ring-primary focus:ring-offset-0"}),e.jsxs("span",{className:"text-sm text-muted-foreground leading-relaxed",children:["I agree to be contacted regarding my request and accept the"," ",e.jsx("button",{type:"button",onClick:()=>N("privacy"),className:"text-primary underline hover:text-primary/80 transition-colors",children:"Privacy Policy"})," ","and"," ",e.jsx("button",{type:"button",onClick:()=>N("terms"),className:"text-primary underline hover:text-primary/80 transition-colors",children:"Terms & Conditions"})]})]}),c.consent&&e.jsx("p",{className:"text-xs text-destructive ml-7",children:c.consent})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Protected by reCAPTCHA"}),e.jsx(R,{type:"submit",size:"lg",className:"w-full",disabled:h||!w,children:h?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"mr-2 h-5 w-5 animate-spin",viewBox:"0 0 24 24",fill:"none",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Submitting..."]}):"Submit Booking Request"})]}),e.jsx(_,{isOpen:null!==y,onClose:()=>N(null),type:y||"privacy"})]})}export{ae as default};